 hadoop出现元数据不能更新且SNN合并失效
 
 原因：要弄清原因首先需要清楚SNN合并流程，NN写editslog流程等等。简单说来如下：

1 在5.3号 SNN合并文件后并成功将合并的数据put到NN。当NN在关闭临时edit文件edit.new，打开edits文件时报错：unable to open 
2 正常情况下，打开edits文件后，会将edits输出流加入前面已经清空的edits输出流列表。在1 失败下，该操作未做，所以edits输出流列表为空表对象
3 打开失败下，会将失败的路径自动移除掉，以便后面的自动尝试恢复。同时自动尝试恢复是在SNN合并文件时出发。但是咱们的情况是2个edits路径全部失败，导致 路径集合为null。
4 新的SNN合并请求过来后会先得到存储路径集合，此时报Null退出 。
5 对于文件操作的日志，因为2操作没有执行，没有可用的edits输出流列表，所以直接往下执行其他操作，导致edits文件也不再更新。

解决思路：
1 因为NN不再更新edits文件，SNN也无法合并Img，所以以前NN保存的元数据无法使用。所以必须恢复元数据到最新。这可以通过hdfs提供的api导出hdfs目录元数据并保存。
这个操作必须在安全模式下执行。
2 从上面5点看，很多操作时由于打不开edit后导致的edits输出流列表为空表（不是Null）和NN的元数据存储路径为Null
3 恢复edits输出流列表，才能让NN正常写edits，这个操作可以调用hdfs提供的api实现。
4 恢复NN的元数据存储路径也可以调用hdfs提供的api重新设置。
解决方案：
1 让集群进入安全模式，使用导出元数据的jsp ，导出最新元数据，停止集群，，拷贝新的元数据替换旧的元数据后重启集群。
2 让集群进入安全模式，使用导出元数据的jsp ，导出最新元数据，拷贝新的元数据替换旧的元数据。恢复edits流列表，恢复NN的元数据存储路径列表，离开安全模式。（测试正常，但没在线上应用）